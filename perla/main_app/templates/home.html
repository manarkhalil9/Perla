{% extends 'base.html' %}

{% block content %}

<div class="row">
  <div class="col s12 m8 offset-m2">

    <h3 class="center-align">Welcome to Perla Planner</h3>
    <p class="center-align grey-text text-darken-1">
      Organize your visions and tasks with calm and elegance.
    </p>

    <hr>

    {% if user.is_authenticated %}
      <h5>My To-Do List</h5>

      <!-- Add Task Form -->
      <div class="card">
        <div class="card-content">
          <form method="POST" action="{% url 'todo_add' %}">
            {% csrf_token %}
            <div class="input-field">
              <input type="text" name="title" id="title" placeholder="Task title" required>
              <label for="title">Task Title</label>
            </div>
            <div class="input-field">
              <input type="date" name="date" id="date" required>
              <label for="date">Due Date</label>
            </div>
            <div class="input-field">
              <input type="text" name="priority" id="priority" placeholder="Priority (low / medium / high)" required>
              <label for="priority">Priority</label>
            </div>
            <div class="center-align">
              <button type="submit" class="btn waves-effect waves-light">Add Task</button>
            </div>
          </form>
        </div>
      </div>

      <!-- To-Do List -->
      <ul class="collection with-header">
        {% for todo in todos %}
          <li class="collection-item">
            {% if todo.is_done %}
              <strike>{{ todo.title }}</strike>
            {% else %}
              {{ todo.title }}
            {% endif %}
            <span class="grey-text right">
              ({{ todo.date }} • {{ todo.priority }})
            </span>
            <div class="secondary-content">
              <a href="{% url 'todo_toggle' todo.id %}" class="green-text">✔</a>
              <a href="{% url 'todo_delete' todo.id %}" class="red-text">✖</a>
            </div>
          </li>
        {% empty %}
          <li class="collection-item">No tasks yet. Add one above!</li>
        {% endfor %}
      </ul>

    {% else %}
      <div class="card-panel yellow lighten-4 center-align">
        <p>
          You are not logged in. Please <a href="{% url 'login' %}">Log In</a> or <a href="{% url 'signup' %}">Sign Up</a> to manage your To-Do list.
        </p>
      </div>
    {% endif %}

  </div>
</div>

{% endblock %}
